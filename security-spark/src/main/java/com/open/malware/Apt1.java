package com.open.malware;

import org.apache.spark.sql.Dataset;
import org.apache.spark.sql.Row;
import org.apache.spark.sql.SparkSession;

import com.open.config.Fmt;

/*
 * Orig sample source - https://www.secrepo.com/pe_static/apt1.zip
 * Format JSON 
 * For data fields and analysis, refer to -
 * https://github.com/cyberdefendersprogram/MachineLearning/blob/master/Data_analysis/PE%20malware%20analysis/VirusShare%20Analysis-checkpoint.ipynb 
 */

public class Apt1 {
	public void process(SparkSession spark) {
		System.out.println("Reading APT1 logs");
		Dataset<Row> df = spark.read().option("timestampFormat", Fmt.GENERIC)
				.option("header", "true").json("resources/malware/APT1/");
		df.printSchema();
		
		df.show();		
		
		
	}

}
